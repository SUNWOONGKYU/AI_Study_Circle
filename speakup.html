<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speak Up — AI Study Circle 110</title>
    <meta name="description" content="AI Study Circle 110 커뮤니티 게시판 - 자유롭게 의견을 나누세요">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css?v=20260205j">
</head>
<body class="speakup-light">

    <!-- Navigation -->
    <nav>
        <div class="nav-inner">
            <a href="index.html" class="nav-logo" style="text-decoration:none;">
                <span class="ai">AI</span>
                <span class="sc">Study Circle</span>
                <span class="brand-num">110</span>
            </a>
            <ul class="nav-links">
                <li><a href="index.html#about">소개</a></li>
                <li><a href="index.html#activities">활동영역</a></li>
                <li><a href="index.html#schedule">모임일정</a></li>
                <li><a href="speakup.html" class="speakup-nav-active">Speak Up</a></li>
                <li><a href="#" id="nav-inquiry-link">문의하기</a></li>
                <!-- 비로그인 상태 -->
                <li id="nav-login-link"><a href="index.html" class="nav-login-btn" data-open-modal="login">로그인</a></li>
                <li id="nav-signup-link"><a href="index.html" class="nav-cta" data-open-modal="signup">멤버 가입</a></li>
                <!-- 로그인 상태 (숨김) -->
                <li id="nav-user-menu" class="nav-user-menu" style="display:none;">
                    <button class="nav-user-btn" id="nav-user-btn">
                        <span id="nav-user-name">사용자</span> ▼
                    </button>
                    <div class="nav-dropdown" id="nav-dropdown">
                        <a href="index.html" class="dropdown-item" data-action="profile">내 프로필</a>
                        <a href="admin.html" class="dropdown-item" id="nav-admin-link" style="display:none;">관리자 페이지</a>
                        <button class="dropdown-item" data-action="logout">로그아웃</button>
                    </div>
                </li>
            </ul>
            <button class="mobile-menu-btn" aria-label="메뉴 열기">☰</button>
        </div>
    </nav>

    <!-- Board Content -->
    <section class="speakup-page">
        <div class="section-inner">
            <div class="section-label">// SPEAK UP</div>
            <h2 class="section-title">커뮤니티</h2>
            <p class="section-desc">AI 관련 아이디어, 의견, 경험, 질문 등을 누구나 자유롭게 이야기해 봅시다.</p>

            <!-- 글쓰기 버튼 (로그인 시만) -->
            <div id="post-write-btn-wrap" class="post-write-btn-wrap" style="display:none;">
                <button type="button" class="btn-primary post-write-open-btn" id="post-write-open-btn">글쓰기</button>
            </div>

            <!-- 글쓰기 폼 (글쓰기 버튼 클릭 시 펼침) -->
            <div id="post-form-wrap" class="post-form-wrap" style="display:none;">
                <form id="post-form" class="site-form post-form">
                    <div class="form-group">
                        <input type="text" id="post-title" placeholder="제목을 입력하세요" required maxlength="200">
                    </div>
                    <div class="form-group">
                        <textarea id="post-content" rows="4" placeholder="내용을 입력하세요" required maxlength="5000"></textarea>
                    </div>
                    <div class="post-form-actions">
                        <button type="button" class="btn-primary post-submit-btn" id="post-submit-btn">등록</button>
                        <button type="button" class="btn-secondary" id="post-cancel-btn">취소</button>
                    </div>
                    <input type="hidden" id="post-edit-id" value="">
                    <div class="form-status" id="post-status"></div>
                </form>
            </div>

            <!-- 비로그인 안내 -->
            <div id="post-login-prompt" class="post-login-prompt" style="display:none;">
                <p>글을 작성하려면 <a href="index.html" class="speakup-login-link">로그인</a>이 필요합니다.</p>
            </div>

            <!-- 게시글 목록 -->
            <div id="posts-container" class="posts-container">
                <div class="admin-loading">게시글을 불러오는 중...</div>
            </div>

            <!-- 더 불러오기 -->
            <div id="load-more-wrap" class="load-more-wrap" style="display:none;">
                <button class="btn-secondary" id="load-more-btn">더 불러오기</button>
            </div>
        </div>
    </section>

    <!-- 문의하기 모달 -->
    <div id="inquiry-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" id="inquiry-close-btn">&times;</button>
            <h2 class="modal-title">문의하기</h2>
            <p style="color:var(--text-muted); margin-bottom:1.5rem;">궁금한 점이나 제안사항을 보내주세요.</p>
            <form id="inquiry-form" class="site-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="inq-name">이름 <span class="required">*</span></label>
                        <input type="text" id="inq-name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="inq-phone">전화번호</label>
                        <input type="tel" id="inq-phone" name="phone" placeholder="01012345678" maxlength="11">
                    </div>
                </div>
                <div class="form-group">
                    <label for="inq-email">이메일</label>
                    <input type="email" id="inq-email" name="email" placeholder="email@example.com">
                </div>
                <div class="form-group">
                    <label for="inq-subject">제목 <span class="required">*</span></label>
                    <input type="text" id="inq-subject" name="subject" required placeholder="문의 제목">
                </div>
                <div class="form-group">
                    <label for="inq-message">내용 <span class="required">*</span></label>
                    <textarea id="inq-message" name="message" rows="5" required maxlength="500" placeholder="문의 내용을 입력해주세요"></textarea>
                </div>
                <button type="submit" class="btn-primary form-submit">문의 보내기 →</button>
                <div class="form-status" id="inquiry-status"></div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-inner">
            <p class="footer-privacy"><a href="privacy.html" style="color: var(--text-muted); text-decoration: none; font-size: 0.85rem;">개인정보 처리방침</a></p>
            <div class="footer-logo">
                <span class="ai">AI</span> Study Circle <span class="brand-num">110</span>
            </div>
            <p class="footer-text"><strong>자율과 창의성 안에서 즐겁게 — 리앤컴퍼니 이미경</strong></p>
            <p class="footer-since"><strong>Since 2026. 1. 10</strong></p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js?v=20260205g"></script>
    <script src="js/speakup.js?v=20260206a"></script>
    <script>
        // 문의하기 모달
        document.addEventListener('DOMContentLoaded', function() {
            const inquiryModal = document.getElementById('inquiry-modal');
            const inquiryCloseBtn = document.getElementById('inquiry-close-btn');
            const navInquiryLink = document.getElementById('nav-inquiry-link');

            if (navInquiryLink) {
                navInquiryLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (inquiryModal) {
                        inquiryModal.classList.add('open');
                        document.body.style.overflow = 'hidden';
                    }
                });
            }

            if (inquiryCloseBtn) {
                inquiryCloseBtn.addEventListener('click', function() {
                    if (inquiryModal) {
                        inquiryModal.classList.remove('open');
                        document.body.style.overflow = '';
                    }
                });
            }

            if (inquiryModal) {
                inquiryModal.addEventListener('click', function(e) {
                    if (e.target === inquiryModal) {
                        inquiryModal.classList.remove('open');
                        document.body.style.overflow = '';
                    }
                });
            }

            // 문의하기 폼 제출
            const inquiryForm = document.getElementById('inquiry-form');
            if (inquiryForm) {
                inquiryForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const statusEl = document.getElementById('inquiry-status');
                    const btn = e.target.querySelector('.form-submit');

                    const name = document.getElementById('inq-name').value.trim();
                    const phone = document.getElementById('inq-phone').value.replace(/[^0-9]/g, '');
                    const email = document.getElementById('inq-email').value.trim();
                    const subject = document.getElementById('inq-subject').value.trim();
                    const message = document.getElementById('inq-message').value.trim();

                    if (!name || !subject || !message) {
                        statusEl.textContent = '이름, 제목, 내용은 필수입니다.';
                        statusEl.className = 'form-status error';
                        return;
                    }

                    statusEl.textContent = '문의 접수 중...';
                    statusEl.className = 'form-status loading';
                    btn.disabled = true;

                    try {
                        await DB.createInquiry({
                            name: name,
                            phone: phone,
                            email: email,
                            subject: subject,
                            message: message,
                            user_id: null
                        });
                        statusEl.textContent = '문의가 접수되었습니다. 감사합니다!';
                        statusEl.className = 'form-status success';
                        document.getElementById('inq-subject').value = '';
                        document.getElementById('inq-message').value = '';

                        // 2초 후 모달 자동 닫기
                        setTimeout(function() {
                            if (inquiryModal) {
                                inquiryModal.classList.remove('open');
                                document.body.style.overflow = '';
                            }
                        }, 2000);
                    } catch (err) {
                        statusEl.textContent = '문의 접수 중 오류가 발생했습니다.';
                        statusEl.className = 'form-status error';
                    } finally {
                        btn.disabled = false;
                    }
                });
            }
        });
    </script>
</body>
</html>
